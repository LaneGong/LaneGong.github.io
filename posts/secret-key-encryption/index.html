<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>对称加密实验 - Lane-诶嘿! Welcome~~</title><meta name="author" content="Lane Gong">
<meta name="author-link" content="https://github.com/LaneGong">
<meta name="description" content="SeedLab密码学对称加密实验过程记录整理，还有待进一步补充，存疑之处欢迎指正和探讨！" /><meta name="keywords" content='网络安全攻防实验, Cryptography' /><meta itemprop="name" content="对称加密实验">
<meta itemprop="description" content="SeedLab密码学对称加密实验过程记录整理，还有待进一步补充，存疑之处欢迎指正和探讨！"><meta itemprop="datePublished" content="2022-12-30T10:00:15+08:00" />
<meta itemprop="dateModified" content="2022-12-30T10:00:15+08:00" />
<meta itemprop="wordCount" content="10861"><meta itemprop="image" content="http://lanegong.top/logo.png"/>
<meta itemprop="keywords" content="网络安全攻防实验,Cryptography," /><meta property="og:title" content="对称加密实验" />
<meta property="og:description" content="SeedLab密码学对称加密实验过程记录整理，还有待进一步补充，存疑之处欢迎指正和探讨！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://lanegong.top/posts/secret-key-encryption/" /><meta property="og:image" content="http://lanegong.top/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-30T10:00:15+08:00" />
<meta property="article:modified_time" content="2022-12-30T10:00:15+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://lanegong.top/logo.png"/>

<meta name="twitter:title" content="对称加密实验"/>
<meta name="twitter:description" content="SeedLab密码学对称加密实验过程记录整理，还有待进一步补充，存疑之处欢迎指正和探讨！"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://lanegong.top/posts/secret-key-encryption/" /><link rel="prev" href="http://lanegong.top/posts/tcp-ip-attack/" /><link rel="next" href="http://lanegong.top/posts/rsa-public-key-encryption-and-signature-lab/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "对称加密实验",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/lanegong.top\/posts\/secret-key-encryption\/"
    },"genre": "posts","keywords": "网络安全攻防实验, Cryptography","wordcount":  10861 ,
    "url": "http:\/\/lanegong.top\/posts\/secret-key-encryption\/","datePublished": "2022-12-30T10:00:15+08:00","dateModified": "2022-12-30T10:00:15+08:00","publisher": {
      "@type": "Organization",
      "name": "Lane","logo": {
          "@type": "ImageObject",
          "url": "http:\/\/lanegong.top\/images\/avatar.jpeg",
          "width":  690 ,
          "height":  684 
        }},"author": {
        "@type": "Person",
        "name": "Lane Gong"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Lane-诶嘿! Welcome~~"><img
    class="lazyload logo"
    src="/svg/loading.min.svg"
    data-src="/images/avatar.jpeg"
    data-srcset="/images/avatar.jpeg, /images/avatar.jpeg 1.5x, /images/avatar.jpeg 2x"
    data-sizes="auto"
    alt="Lane-诶嘿! Welcome~~"
    title="Lane-诶嘿! Welcome~~" width="690" height="684"/><span class="header-title-text">Lane の Blog</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item has-children">
              <a
                class="menu-link"
                href="/posts/"
                title="查看所有文章"
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 归档</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i>
                <ul class="sub-menu">
                  <li
                        class="menu-item"
                      >
                        <a
                          class="menu-link"
                          href="/categories/"
                          
                          
                        ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a>
                      </li><li
                        class="menu-item"
                      >
                        <a
                          class="menu-link"
                          href="/tags/"
                          
                          
                        ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a>
                      </li></ul></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                title="友情链接"
                
              ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/fun/"
                title="正在开发中..."
                
              ><i class="fa-solid fa-fan fa-fw fa-sm" aria-hidden="true"></i> 趣味</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/guides/"
                title="常用站点指南"
                
              ><i class="fa-solid fa-subway fa-fw fa-sm" aria-hidden="true"></i> 站点导航</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容 ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Lane-诶嘿! Welcome~~"><img
    class="lazyload logo"
    src="/svg/loading.min.svg"
    data-src="/images/avatar.jpeg"
    data-srcset="/images/avatar.jpeg, /images/avatar.jpeg 1.5x, /images/avatar.jpeg 2x"
    data-sizes="auto"
    alt="/images/avatar.jpeg"
    title="/images/avatar.jpeg" width="690" height="684"/><span class="header-title-text">Lane の Blog</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容 ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><span class="nested-item">
                  <a
                    class="menu-link"
                    href="/posts/"
                    title="查看所有文章"
                    
                  ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 归档</a>
                  <i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden="true"></i>
                </span>
                <ul class="sub-menu">
                  <li
                        class="menu-item"
                      >
                        <a
                          class="menu-link"
                          href="/categories/"
                          
                          
                        ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a>
                      </li><li
                        class="menu-item"
                      >
                        <a
                          class="menu-link"
                          href="/tags/"
                          
                          
                        ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a>
                      </li></ul></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  title="友情链接"
                  
                ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/fun/"
                  title="正在开发中..."
                  
                ><i class="fa-solid fa-fan fa-fw fa-sm" aria-hidden="true"></i> 趣味</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/guides/"
                  title="常用站点指南"
                  
                ><i class="fa-solid fa-subway fa-fw fa-sm" aria-hidden="true"></i> 站点导航</a></li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container" data-page-style="normal"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX">
        <span>对称加密实验</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/LaneGong" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img
    class="lazyload avatar"
    src="/svg/loading.min.svg"
    data-src="/images/avatar.jpeg"
    data-srcset="/images/avatar.jpeg, /images/avatar.jpeg 1.5x, /images/avatar.jpeg 2x"
    data-sizes="auto"
    alt="Lane Gong"
    title="Lane Gong" width="690" height="684"/>&nbsp;Lane Gong</a></span>
          <span class="post-category">收录于 <a href="/categories/seedlab/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> SeedLab</a></span></div>
      <div class="post-meta-line"><span title=2022-12-30&#32;10:00:15><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-12-30">2022-12-30</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i> 约 10861 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden="true"></i> 预计阅读 22 分钟</span>&nbsp;<span id="busuanzi_container_page_pv" class="busuanzi_visitors comment-visitors" data-flag-title="对称加密实验">
            <i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_page_pv">-</span>&nbsp;次阅读
          </span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#task-1-frequency-analysis">Task 1: Frequency Analysis</a></li>
    <li><a href="#task-2-encryption-using-different-ciphers-and-modes">Task 2: Encryption using Different Ciphers and Modes</a>
      <ul>
        <li><a href="#-aes-128-cbc">-aes-128-cbc</a></li>
        <li><a href="#-aes-128-cfb">-aes-128-cfb</a></li>
        <li><a href="#tip">Tip！</a></li>
        <li><a href="#-aes-128-ecb">-aes-128-ecb</a></li>
        <li><a href="#-bf-cbc">-bf-cbc</a></li>
      </ul>
    </li>
    <li><a href="#task-3-encryption-mode--ecb-vs-cbc">Task 3: Encryption Mode – ECB vs. CBC</a>
      <ul>
        <li><a href="#实验ecb模式">实验(ECB模式)</a></li>
        <li><a href="#实验cbc模式">实验(CBC模式)</a></li>
        <li><a href="#自选图片观察">自选图片观察</a></li>
      </ul>
    </li>
    <li><a href="#task-4-padding">Task 4: Padding</a></li>
    <li><a href="#task-5-error-propagation--corrupted-cipher-text">Task 5: Error Propagation – Corrupted Cipher Text</a></li>
    <li><a href="#task-6-initial-vector-iv-and-common-mistakes">Task 6: Initial Vector (IV) and Common Mistakes</a>
      <ul>
        <li><a href="#61-iv-experiment">6.1 IV Experiment</a></li>
        <li><a href="#62-common-mistake-use-the-same-iv">6.2. Common Mistake: Use the Same IV</a></li>
        <li><a href="#63-common-mistake-use-a-predictable-iv">6.3. Common Mistake: Use a Predictable IV</a></li>
      </ul>
    </li>
    <li><a href="#task-7-programming-using-the-crypto-library">Task 7: Programming using the Crypto Library</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><p>SeedLab密码学对称加密实验过程记录整理，还有待进一步补充，存疑之处欢迎指正和探讨！</p>
<blockquote>
<p>实验来源：<a href="https://github.com/seed-labs/seed-labs"target="_blank" rel="external nofollow noopener noreferrer">seed-labs</a></p>
<p>实验环境：SEEDUbuntu 20.04 VM</p>
</blockquote>
<h2 id="task-1-frequency-analysis">Task 1: Frequency Analysis</h2>
<p>In this lab, you are given a cipher-text that is encrypted using a monoalphabetic cipher; namely, each letter in the original text is replaced by another letter, where the replacement does not vary (i.e., a letter is always replaced by the same letter during the encryption). Your job is to find out the original text using frequency analysis. It is known that the original text is an English article.</p>
<blockquote>
<p>明文加密方式详见实验指导手册：<a href="https://seedsecuritylabs.org/Labs_20.04/Files/Crypto_Encryption/Crypto_Encryption.pdf"target="_blank" rel="external nofollow noopener noreferrer">Secret-Key Encryption Lab</a></p>
</blockquote>
<p>ciphertext.txt:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">ytn xqavhq yzhu  xu qzupvd ltmat qnncq vgxzy hmrty vbynh ytmq ixur qyhvurn
</span></span><span class="line"><span class="cl">vlvhpq yhme ytn gvrrnh bnniq imsn v uxuvrnuvhmvu yxx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ytn vlvhpq hvan lvq gxxsnupnp gd ytn pncmqn xb tvhfnd lnmuqynmu vy myq xzyqny
</span></span><span class="line"><span class="cl">vup ytn veevhnuy mceixqmxu xb tmq bmic axcevud vy ytn nup vup my lvq qtvenp gd
</span></span><span class="line"><span class="cl">ytn ncnhrnuan xb cnyxx ymcnq ze givasrxlu eximymaq vhcavupd vaymfmqc vup
</span></span><span class="line"><span class="cl">v uvymxuvi axufnhqvymxu vq ghmnb vup cvp vq v bnfnh phnvc vgxzy ltnytnh ytnhn
</span></span><span class="line"><span class="cl">xzrty yx gn v ehnqmpnuy lmubhnd ytn qnvqxu pmpuy ozqy qnnc nkyhv ixur my lvq
</span></span><span class="line"><span class="cl">nkyhv ixur gnavzqn ytn xqavhq lnhn cxfnp yx ytn bmhqy lnnsnup mu cvhat yx
</span></span><span class="line"><span class="cl">vfxmp axubimaymur lmyt ytn aixqmur anhncxud xb ytn lmuynh xidcemaq ytvusq
</span></span><span class="line"><span class="cl">ednxuratvur
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">xun gmr jznqymxu qzhhxzupmur ytmq dnvhq vavpncd vlvhpq mq txl xh mb ytn
</span></span><span class="line"><span class="cl">anhncxud lmii vpphnqq cnyxx nqenamviid vbynh ytn rxipnu rixgnq ltmat gnavcn
</span></span><span class="line"><span class="cl">v ozgmivuy axcmurxzy evhyd bxh ymcnq ze ytn cxfncnuy qenvhtnvpnp gd 
</span></span><span class="line"><span class="cl">exlnhbzi txiidlxxp lxcnu ltx tnienp hvmqn cmiimxuq xb pxiivhq yx bmrty qnkzvi
</span></span><span class="line"><span class="cl">tvhvqqcnuy vhxzup ytn axzuyhd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">qmruvimur ytnmh qzeexhy rxipnu rixgnq vyynupnnq qlvytnp ytncqnifnq mu givas
</span></span><span class="line"><span class="cl">qexhynp iveni emuq vup qxzupnp xbb vgxzy qnkmqy exlnh mcgvivuanq bhxc ytn hnp
</span></span><span class="line"><span class="cl">avheny vup ytn qyvrn xu ytn vmh n lvq aviinp xzy vgxzy evd munjzmyd vbynh
</span></span><span class="line"><span class="cl">myq bxhcnh vuatxh avyy qvpinh jzmy xuan qtn invhunp ytvy qtn lvq cvsmur bvh
</span></span><span class="line"><span class="cl">inqq ytvu v cvin axtxqy vup pzhmur ytn anhncxud uvyvimn exhycvu yxxs v gizuy
</span></span><span class="line"><span class="cl">vup qvymqbdmur pmr vy ytn viicvin hxqynh xb uxcmuvynp pmhnayxhq txl axzip
</span></span><span class="line"><span class="cl">ytvy gn yxeenp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">vq my yzhuq xzy vy invqy mu ynhcq xb ytn xqavhq my ehxgvgid lxuy gn
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lxcnu mufxifnp mu ymcnq ze qvmp ytvy viytxzrt ytn rixgnq qmrumbmnp ytn
</span></span><span class="line"><span class="cl">mumymvymfnq ivzuat ytnd unfnh muynupnp my yx gn ozqy vu vlvhpq qnvqxu
</span></span><span class="line"><span class="cl">avcevmru xh xun ytvy gnavcn vqqxamvynp xuid lmyt hnpavheny vaymxuq muqynvp
</span></span><span class="line"><span class="cl">v qexsnqlxcvu qvmp ytn rhxze mq lxhsmur gntmup aixqnp pxxhq vup tvq qmuan
</span></span><span class="line"><span class="cl">vcvqqnp  cmiimxu bxh myq inrvi pnbnuqn bzup ltmat vbynh ytn rixgnq lvq
</span></span><span class="line"><span class="cl">bixxpnp lmyt ytxzqvupq xb pxuvymxuq xb  xh inqq bhxc enxein mu qxcn 
</span></span><span class="line"><span class="cl">axzuyhmnq
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ux avii yx lnvh givas rxluq lnuy xzy mu vpfvuan xb ytn xqavhq ytxzrt ytn
</span></span><span class="line"><span class="cl">cxfncnuy lmii vicxqy anhyvmuid gn hnbnhnuanp gnbxhn vup pzhmur ytn anhncxud 
</span></span><span class="line"><span class="cl">nqenamviid qmuan fxavi cnyxx qzeexhynhq imsn vqtind ozpp ivzhv pnhu vup
</span></span><span class="line"><span class="cl">umaxin smpcvu vhn qatnpzinp ehnqnuynhq
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">vuxytnh bnvyzhn xb ytmq qnvqxu ux xun hnviid suxlq ltx mq rxmur yx lmu gnqy
</span></span><span class="line"><span class="cl">emayzhn vhrzvgid ytmq tveenuq v ixy xb ytn ymcn muvhrzvgid ytn uvmigmynh
</span></span><span class="line"><span class="cl">uvhhvymfn xuid qnhfnq ytn vlvhpq tden cvatmun gzy xbynu ytn enxein bxhnavqymur
</span></span><span class="line"><span class="cl">ytn hvan qxaviinp xqavhxixrmqyq avu cvsn xuid npzavynp rznqqnq
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ytn lvd ytn vavpncd yvgzivynq ytn gmr lmuunh pxnquy tnie mu nfnhd xytnh
</span></span><span class="line"><span class="cl">avynrxhd ytn uxcmunn lmyt ytn cxqy fxynq lmuq gzy mu ytn gnqy emayzhn
</span></span><span class="line"><span class="cl">avynrxhd fxynhq vhn vqsnp yx imqy ytnmh yxe cxfmnq mu ehnbnhnuymvi xhpnh mb v
</span></span><span class="line"><span class="cl">cxfmn rnyq cxhn ytvu  enhanuy xb ytn bmhqyeivan fxynq my lmuq ltnu ux
</span></span><span class="line"><span class="cl">cxfmn cvuvrnq ytvy ytn xun lmyt ytn bnlnqy bmhqyeivan fxynq mq nimcmuvynp vup
</span></span><span class="line"><span class="cl">myq fxynq vhn hnpmqyhmgzynp yx ytn cxfmnq ytvy rvhunhnp ytn nimcmuvynp gviixyq
</span></span><span class="line"><span class="cl">qnaxupeivan fxynq vup ytmq axuymuznq zuymi v lmuunh ncnhrnq
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">my mq vii ynhhmgid axubzqmur gzy veevhnuyid ytn axuqnuqzq bvfxhmyn axcnq xzy
</span></span><span class="line"><span class="cl">vtnvp mu ytn nup ytmq cnvuq ytvy nupxbqnvqxu vlvhpq atvyynh mufvhmvgid
</span></span><span class="line"><span class="cl">mufxifnq yxhyzhnp qenazivymxu vgxzy ltmat bmic lxzip cxqy imsnid gn fxynhq
</span></span><span class="line"><span class="cl">qnaxup xh ytmhp bvfxhmyn vup ytnu njzviid yxhyzhnp axuaizqmxuq vgxzy ltmat
</span></span><span class="line"><span class="cl">bmic cmrty ehnfvmi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mu  my lvq v yxqqze gnylnnu gxdtxxp vup ytn nfnuyzvi lmuunh gmhpcvu
</span></span><span class="line"><span class="cl">mu  lmyt ixyq xb nkenhyq gnyymur xu ytn hnfnuvuy xh ytn gmr qtxhy ytn
</span></span><span class="line"><span class="cl">ehmwn lnuy yx qexyimrty ivqy dnvh unvhid vii ytn bxhnavqynhq pnaivhnp iv
</span></span><span class="line"><span class="cl">iv ivup ytn ehnqzceymfn lmuunh vup bxh ylx vup v tvib cmuzynq ytnd lnhn
</span></span><span class="line"><span class="cl">axhhnay gnbxhn vu nufnixen quvbz lvq hnfnvinp vup ytn hmrtybzi lmuunh
</span></span><span class="line"><span class="cl">cxxuimrty lvq ahxlunp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ytmq dnvh vlvhpq lvyatnhq vhn zunjzviid pmfmpnp gnylnnu ythnn gmiigxvhpq
</span></span><span class="line"><span class="cl">xzyqmpn nggmur cmqqxzhm ytn bvfxhmyn vup ytn qtven xb lvynh ltmat mq
</span></span><span class="line"><span class="cl">ytn gvrrnhq ehnpmaymxu lmyt v bnl bxhnavqymur v tvmi cvhd lmu bxh rny xzy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gzy vii xb ytxqn bmicq tvfn tmqyxhmavi xqavhfxymur evyynhuq vrvmuqy ytnc ytn
</span></span><span class="line"><span class="cl">qtven xb lvynh tvq  uxcmuvymxuq cxhn ytvu vud xytnh bmic vup lvq viqx
</span></span><span class="line"><span class="cl">uvcnp ytn dnvhq gnqy gd ytn ehxpzanhq vup pmhnayxhq rzmipq dny my lvq uxy
</span></span><span class="line"><span class="cl">uxcmuvynp bxh v qahnnu vayxhq rzmip vlvhp bxh gnqy nuqncgin vup ux bmic tvq
</span></span><span class="line"><span class="cl">lxu gnqy emayzhn lmytxzy ehnfmxzqid ivupmur vy invqy ytn vayxhq uxcmuvymxu
</span></span><span class="line"><span class="cl">qmuan ghvfntnvhy mu  ytmq dnvh ytn gnqy nuqncgin qvr nupnp ze rxmur yx
</span></span><span class="line"><span class="cl">ythnn gmiigxvhpq ltmat mq qmrumbmavuy gnavzqn vayxhq cvsn ze ytn vavpncdq
</span></span><span class="line"><span class="cl">ivhrnqy ghvuat ytvy bmic ltmin pmfmqmfn viqx lxu ytn gnqy phvcv rxipnu rixgn
</span></span><span class="line"><span class="cl">vup ytn gvbyv gzy myq bmiccvsnh cvhymu capxuvrt lvq uxy uxcmuvynp bxh gnqy
</span></span><span class="line"><span class="cl">pmhnayxh vup vevhy bhxc vhrx cxfmnq ytvy ivup gnqy emayzhn lmytxzy viqx
</span></span><span class="line"><span class="cl">nvhumur gnqy pmhnayxh uxcmuvymxuq vhn bnl vup bvh gnylnnu
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>
<p>利用python对文本进行频率统计</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="n">TOP_K</span>  <span class="o">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl"><span class="n">N_GRAM</span> <span class="o">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Generate all the n-grams for value n</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ngrams</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Ignore n-grams containing white space</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">           <span class="k">yield</span> <span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Read the data from the ciphertext</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ciphertext.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Count, sort, and print out the n-grams</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_GRAM</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------------------------------------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">{}</span><span class="s2">-gram (top </span><span class="si">{}</span><span class="s2">):&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">TOP_K</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   <span class="n">counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">ngrams</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>        <span class="c1"># Count</span>
</span></span><span class="line"><span class="cl">   <span class="n">sorted_counts</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="n">TOP_K</span><span class="p">)</span>  <span class="c1"># Sort </span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">ngram</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sorted_counts</span><span class="p">:</span>                  
</span></span><span class="line"><span class="cl">       <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ngram</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>   <span class="c1"># Print</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>助理解资料：</p>
<ol>
<li><a href="https://blog.csdn.net/sinat_28576553/article/details/99131954"target="_blank" rel="external nofollow noopener noreferrer">Python计数器collections.Counter用法详解</a></li>
<li><a href="https://www.runoob.com/w3cnote/python-yield-used-analysis.html"target="_blank" rel="external nofollow noopener noreferrer">Python yield 使用浅析</a></li>
</ol>
</blockquote>
<p>统计结果：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214113043573.png"
    data-srcset="/images/image-20221214113043573.png, /images/image-20221214113043573.png 1.5x, /images/image-20221214113043573.png 2x"
    data-sizes="auto"
    alt="image-20221214113043573"
    title="image-20221214113043573" width="1079" height="599"/></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214113210626.png"
    data-srcset="/images/image-20221214113210626.png, /images/image-20221214113210626.png 1.5x, /images/image-20221214113210626.png 2x"
    data-sizes="auto"
    alt="image-20221214113210626"
    title="image-20221214113210626" width="1079" height="579"/></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214113239071.png"
    data-srcset="/images/image-20221214113239071.png, /images/image-20221214113239071.png 1.5x, /images/image-20221214113239071.png 2x"
    data-sizes="auto"
    alt="image-20221214113239071"
    title="image-20221214113239071" width="1079" height="564"/></p>
</li>
<li>
<p>根据统计结果，利用维基百科提供的<a href="https://en.wikipedia.org/wiki/Letter_frequency"target="_blank" rel="external nofollow noopener noreferrer">单字母相对频率分布</a>、<a href="https://en.wikipedia.org/wiki/Bigram"target="_blank" rel="external nofollow noopener noreferrer">双字母组合</a>、<a href="https://en.wikipedia.org/wiki/Trigram"target="_blank" rel="external nofollow noopener noreferrer">三字母组合</a>进行频率分析。</p>
<p>根据文本中单字母出现最高频一般都是e(13%)的统计过规律，考虑将密文中单字母最高频的n替换成e，根据常规文本统计中双字母出现频率最高的是th(3.56%)和三字母中最高的是the(1.81%)，结合刚才的单字母替换和密文统计规律(双字母yt，三字母ytn)，合理考虑密文y替换成明文t，密文t替换成明文h。</p>
<blockquote>
<p>For those characters, you may want to change them back to its plaintext, as you may be able to get more clues. It is better to use capital letters for plaintext, so for the same letter, we know which is plaintext and which is ciphertext.  =&gt; 因此密钥表中密文也是直接用小写，明文用大写示意。</p>
</blockquote>
<p>Encryption Key(加密密钥表)：</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>n</td>
<td></td>
<td></td>
<td>t</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>明文</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>y</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>将已进行猜测过的替换修改进密文文本中进一步观察分析：<code>tr 'ytn' 'THE' &lt; ciphertext.txt &gt; plaintext.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214132212802.png"
    data-srcset="/images/image-20221214132212802.png, /images/image-20221214132212802.png 1.5x, /images/image-20221214132212802.png 2x"
    data-sizes="auto"
    alt="image-20221214132212802"
    title="image-20221214132212802" width="1054" height="681"/></p>
<p>仔细分析文本，可以发现这里面出现了很多的vT，T是没有问题的，那对于t前面可能的搭配只有it or at ，根据维基百科双字母的频率分布，暂考虑是at(1.49%)，也就是v~A。再看这里面出现了很多Tx，同理可能的搭配只有to，因此考虑x~O。</p>
<p>Encryption Key(加密密钥表)：</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>v</td>
<td></td>
<td></td>
<td></td>
<td>n</td>
<td></td>
<td></td>
<td>t</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>明文</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td></td>
<td>x</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>y</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>替换后进一步分析：<code>tr 'xv' 'OA' &lt; plaintext.txt &gt; plaintext1.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214143323533.png"
    data-srcset="/images/image-20221214143323533.png, /images/image-20221214143323533.png 1.5x, /images/image-20221214143323533.png 2x"
    data-sizes="auto"
    alt="image-20221214143323533"
    title="image-20221214143323533" width="1131" height="839"/></p>
<p>借助python(略修改)再扫一遍频率：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214143509536.png"
    data-srcset="/images/image-20221214143509536.png, /images/image-20221214143509536.png 1.5x, /images/image-20221214143509536.png 2x"
    data-sizes="auto"
    alt="image-20221214143509536"
    title="image-20221214143509536" width="1051" height="655"/></p>
<p>对照维基百科，高频的E、T、A、O已经出现，接下来是I、N。二维中TH、HE已经出现，IN、ER、AN和RE还未出现。三维中THE已出现，AND、THA、ENT、OFT还未出现。</p>
<p>结合密文现状，文中有很多Aup，考虑u对应N，p对应D；在u为N的情况下，考虑m为I；根据三维中OzT出现的频率高，考虑z为F。检验效果。</p>
<p>Encryption Key(加密密钥表)：</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>v</td>
<td></td>
<td></td>
<td>p</td>
<td>n</td>
<td>z</td>
<td></td>
<td>t</td>
<td>m</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>明文</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>u</td>
<td>x</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>y</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>替换进密文中观察分析：<code>tr 'upmz' 'NDIF' &lt; plaintext1.txt &gt; plaintext2.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214144854455.png"
    data-srcset="/images/image-20221214144854455.png, /images/image-20221214144854455.png 1.5x, /images/image-20221214144854455.png 2x"
    data-sizes="auto"
    alt="image-20221214144854455"
    title="image-20221214144854455" width="1024" height="838"/></p>
<p>替换完后看到TFhN，感觉不太对应该没有什么tf*n的，后面F出现的位置也很怪异，因此F换回z。</p>
<p>相反观察到非常多的Ob单词，考虑到的搭配是of、ok、or（on已出现）。根据频率统计优先级是or、of(先保留)。</p>
<p>观察到THIq，考虑会不会是this，q~S，并且q出现的词频是非常高的，符合统计规律中S的词频，再加上后面有qAID 感觉是said合理。</p>
<p>文中出现了个长词：NONArENAhIAN，通过检索，很可能的原词是nonagenarian，因此考虑r~G，h~R。</p>
<p>由此上面b~F。</p>
<p>Encryption Key(加密密钥表)：</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>v</td>
<td></td>
<td></td>
<td>p</td>
<td>n</td>
<td>b</td>
<td>r</td>
<td>t</td>
<td>m</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>明文</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>u</td>
<td>x</td>
<td></td>
<td></td>
<td>h</td>
<td>q</td>
<td>y</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>替换进密文中观察分析。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214153645368.png"
    data-srcset="/images/image-20221214153645368.png, /images/image-20221214153645368.png 1.5x, /images/image-20221214153645368.png 2x"
    data-sizes="auto"
    alt="/images/image-20221214153645368.png"
    title="/images/image-20221214153645368.png" width="1130" height="729"/></p>
<p>已经有些成型了，坚持！</p>
<p>看到AlARDS，猜测是awards，也就是l~W；</p>
<p>OSaARS，猜测oscars，即a~C；</p>
<p>OzTSET，猜测outset，即z~U；</p>
<p>NATIONAi，猜测national，即i~L；</p>
<p>SzNDAd，猜测Sunday，即d~Y；</p>
<p>AgOzT，猜测about，即g~B；</p>
<p>Encryption Key(加密密钥表)：</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>v</td>
<td>g</td>
<td>a</td>
<td>p</td>
<td>n</td>
<td>b</td>
<td>r</td>
<td>t</td>
<td>m</td>
<td></td>
<td></td>
<td>i</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>明文</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>u</td>
<td>x</td>
<td></td>
<td></td>
<td>h</td>
<td>q</td>
<td>y</td>
<td>z</td>
<td></td>
<td>l</td>
<td></td>
<td>d</td>
<td></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>替换进密文中分析：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214155054269.png"
    data-srcset="/images/image-20221214155054269.png, /images/image-20221214155054269.png 1.5x, /images/image-20221214155054269.png 2x"
    data-sizes="auto"
    alt="image-20221214155054269"
    title="image-20221214155054269" width="1074" height="838"/></p>
<p>jUESTION猜测question，即j~Q；</p>
<p>IN TERcS OF 猜测in terms of，即c~M；</p>
<p>eROBABLY猜测probably，即e~P；</p>
<p>oUBILANT猜测jubilant，即o~J；</p>
<p>fOTES猜测votes，即f~V；</p>
<p>LIsELY猜测likely，即s~K；</p>
<p>SEkIST猜测sexist，即k~X；</p>
<p>则最后一个w对应Z；</p>
<p><strong>Encryption Key(加密密钥表)：</strong></p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
<th>I</th>
<th>J</th>
<th>K</th>
<th>L</th>
<th>M</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>v</td>
<td>g</td>
<td>a</td>
<td>p</td>
<td>n</td>
<td>b</td>
<td>r</td>
<td>t</td>
<td>m</td>
<td>o</td>
<td>s</td>
<td>i</td>
<td>c</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>明文</th>
<th>N</th>
<th>O</th>
<th>P</th>
<th>Q</th>
<th>R</th>
<th>S</th>
<th>T</th>
<th>U</th>
<th>V</th>
<th>W</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
</tr>
</thead>
<tbody>
<tr>
<td>密文</td>
<td>u</td>
<td>x</td>
<td>e</td>
<td>j</td>
<td>h</td>
<td>q</td>
<td>y</td>
<td>z</td>
<td>f</td>
<td>l</td>
<td>k</td>
<td>d</td>
<td>w</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>最后根据密钥表就可以将最终明文给破译出来了！！明文(部分)如下：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221214161046969.png"
    data-srcset="/images/image-20221214161046969.png, /images/image-20221214161046969.png 1.5x, /images/image-20221214161046969.png 2x"
    data-sizes="auto"
    alt="image-20221214161046969"
    title="image-20221214161046969" width="1208" height="475"/></p>
<h2 id="task-2-encryption-using-different-ciphers-and-modes">Task 2: Encryption using Different Ciphers and Modes</h2>
<p>You can use the following <code>openssl enc</code> command to encrypt/decrypt a file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ openssl enc -ciphertype -e -in plain.txt -out cipher.bin <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>-K 00112233445566778889aabbccddeeff <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>-iv <span class="m">0102030405060708</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>-in  input file</li>
<li>-out  output file</li>
<li>-e encrypt</li>
<li>-d decrypt</li>
<li>-K/-iv key/iv in hex is the next argument =&gt; key是密钥，iv是initialization vector</li>
<li>-[pP] print the iv/key (then exit if -P)</li>
</ul>
<blockquote>
<p>查看具体使用说明<code>man openssl</code>、<code>man enc</code></p>
</blockquote>
<p>Task target: In this task, you should try at least 3 different ciphers.</p>
<blockquote>
<p>理论知识参考：</p>
<ol>
<li><a href="https://www.cnblogs.com/starwolf/p/3365834.html"target="_blank" rel="external nofollow noopener noreferrer">AES五种加密模式（CBC、ECB、CTR、OCF、CFB）</a></li>
<li><a href="https://www.cnblogs.com/gordon0918/p/5317701.html"target="_blank" rel="external nofollow noopener noreferrer">openssl 对称加密算法enc命令详解 </a></li>
<li><a href="https://blog.csdn.net/chengqiuming/article/details/82355772"target="_blank" rel="external nofollow noopener noreferrer">CFB模式解读</a></li>
</ol>
</blockquote>
<h3 id="-aes-128-cbc">-aes-128-cbc</h3>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219113152741.png"
    data-srcset="/images/image-20221219113152741.png, /images/image-20221219113152741.png 1.5x, /images/image-20221219113152741.png 2x"
    data-sizes="auto"
    alt="image-20221219113152741"
    title="image-20221219113152741" width="966" height="465"/></p>
<p>密码分组链接模式(Cipher Block Chaining (CBC)): 这种模式是先将明文切分成若干小段，然后每一小段与初始块或者上一段的密文段进行异或运算后，再与密钥进行加密。</p>
<p>实验：</p>
<ol>
<li>
<p>将task1中解密出的文本plain.txt(plaintext.txt备份重命名)作为明文文本: <code>cp ./plaintext.txt ./plain.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219145405246.png"
    data-srcset="/images/image-20221219145405246.png, /images/image-20221219145405246.png 1.5x, /images/image-20221219145405246.png 2x"
    data-sizes="auto"
    alt="image-20221219145405246"
    title="image-20221219145405246" width="1042" height="366"/></p>
</li>
<li>
<p>加密命令：<code>openssl enc -aes-128-cbc -e -in plain.txt -out cipher.bin -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p>注意：key和iv值是16进制</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219143111112.png"
    data-srcset="/images/image-20221219143111112.png, /images/image-20221219143111112.png 1.5x, /images/image-20221219143111112.png 2x"
    data-sizes="auto"
    alt="image-20221219143111112"
    title="image-20221219143111112" width="1045" height="155"/></p>
<p>其中salt是盐值(本次演示不涉及)。为了增强安全性，在把用户密码(pass参数)转换成加密密钥的时候需要使用盐值，默认盐值随机生成。使用-S参数，则盐值由用户指定。也可指用-nosalt指定不使用盐值，但降低了安全性，不推荐使用。</p>
<div class="details admonition tip open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-lightbulb fa-fw" aria-hidden="true"></i>Tip<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">首先补充一下关于key和iv的位数疑惑：密钥128位？看执行命令后的提示也是由于太短位数不够，用0字节填充至指定长度？但是看-p参数打印出来的补齐现状发现这不是只有32位？何来128位？ =&gt; 忽略了前面的注意提醒和对单位换算理解不敏感，首先这32位字符是16进制，前面所提128位是指128bit(16字节)，这里已经可以感受量纲的不同，一位16进制字符可以用4个二进制位来表示，即1对4bit的关系，因此实际上正是32x4=128bit。</div>
    </div>
  </div>
</li>
<li>
<p>查看加密后的文本cipher.bin</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219145249672.png"
    data-srcset="/images/image-20221219145249672.png, /images/image-20221219145249672.png 1.5x, /images/image-20221219145249672.png 2x"
    data-sizes="auto"
    alt="image-20221219145249672"
    title="image-20221219145249672" width="1042" height="366"/></p>
</li>
<li>
<p>解密cipher.bin文件至plain1.txt：<code>openssl enc -aes-128-cbc -d -in cipher.bin -out plain1.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219145736890.png"
    data-srcset="/images/image-20221219145736890.png, /images/image-20221219145736890.png 1.5x, /images/image-20221219145736890.png 2x"
    data-sizes="auto"
    alt="image-20221219145736890"
    title="image-20221219145736890" width="1048" height="165"/></p>
</li>
<li>
<p>查看解密后的文件plain1.txt</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219145819119.png"
    data-srcset="/images/image-20221219145819119.png, /images/image-20221219145819119.png 1.5x, /images/image-20221219145819119.png 2x"
    data-sizes="auto"
    alt="image-20221219145819119"
    title="image-20221219145819119" width="1028" height="418"/></p>
</li>
</ol>
<h3 id="-aes-128-cfb">-aes-128-cfb</h3>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/12232528-c5c4946255a849379be143aaca8d1ecf.png"
    data-srcset="/images/12232528-c5c4946255a849379be143aaca8d1ecf.png, /images/12232528-c5c4946255a849379be143aaca8d1ecf.png 1.5x, /images/12232528-c5c4946255a849379be143aaca8d1ecf.png 2x"
    data-sizes="auto"
    alt="img"
    title="img" width="739" height="480"/></p>
<p>密码反馈模式(Cipher FeedBack (CFB)): 前一个密文分组会被送回到密码算法的输入端。所谓反馈，这里指的就是返回输入端的意思。=&gt; 再写一遍引用：<a href="https://blog.csdn.net/chengqiuming/article/details/82355772"target="_blank" rel="external nofollow noopener noreferrer">CFB模式解读</a>可以阅读一下，理清了和cbc、ecb等的区别。</p>
<p>实验:</p>
<ol>
<li>
<p>明文仍旧使用plain.txt</p>
</li>
<li>
<p>加密：<code>openssl enc -aes-128-cfb -e -in plain.txt -out cipher1.bin -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219164222300.png"
    data-srcset="/images/image-20221219164222300.png, /images/image-20221219164222300.png 1.5x, /images/image-20221219164222300.png 2x"
    data-sizes="auto"
    alt="image-20221219164222300"
    title="image-20221219164222300" width="1045" height="185"/></p>
<p>查看结果：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219164309065.png"
    data-srcset="/images/image-20221219164309065.png, /images/image-20221219164309065.png 1.5x, /images/image-20221219164309065.png 2x"
    data-sizes="auto"
    alt="image-20221219164309065"
    title="image-20221219164309065" width="1045" height="290"/></p>
</li>
<li>
<p>解密：<code>openssl enc -aes-128-cfb -d -in cipher1.bin -out plain2.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219164459026.png"
    data-srcset="/images/image-20221219164459026.png, /images/image-20221219164459026.png 1.5x, /images/image-20221219164459026.png 2x"
    data-sizes="auto"
    alt="image-20221219164459026"
    title="image-20221219164459026" width="1042" height="178"/></p>
<p>查看结果：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219164531406.png"
    data-srcset="/images/image-20221219164531406.png, /images/image-20221219164531406.png 1.5x, /images/image-20221219164531406.png 2x"
    data-sizes="auto"
    alt="image-20221219164531406"
    title="image-20221219164531406" width="1021" height="367"/></p>
</li>
</ol>
<h3 id="tip">Tip！</h3>
<p>通过这2个小实验的研究，我觉得对于理解算法和模式这两个概念是更加有想法了。参考《图解密码技术》，对于模式的粗略说法是如DES每次只能加密64比特的数据，如果要加密的明文比较长，就需要对DES加密进行迭代(反复)，而迭代的具体方式就称为模式。原先有些抽象，觉得模式和算法这不是一回事吗？都是在数据加密啊？现在看法有所改观：首先从实例上看，如DES、AES这些称作算法，CFB、CBC、EBC这些称作模式；再次从上述原理图来理解，表述在下图了(纯个人当下所想，描述出来有点舒服~hhhh，不正确之处还请指正!)。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219161520620.png"
    data-srcset="/images/image-20221219161520620.png, /images/image-20221219161520620.png 1.5x, /images/image-20221219161520620.png 2x"
    data-sizes="auto"
    alt="image-20221219161520620"
    title="image-20221219161520620" width="924" height="479"/></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221230101010096.png"
    data-srcset="/images/image-20221230101010096.png, /images/image-20221230101010096.png 1.5x, /images/image-20221230101010096.png 2x"
    data-sizes="auto"
    alt="image-20221230101010096"
    title="image-20221230101010096" width="862" height="686"/></p>
<p>像所谓的DES本质是16轮Feistel网络，其实它只是加密算法，他只在加密一个分组，向上面书中提到的64bit，它16轮之后是完成了对这一分组的加密，就理解成下面的加密器，你输入一个分组，他按照des算法16轮后给你一个密文分组。但是对于一个很长的明文段加密工作来说这只是1/n步(明文分成n个分组)，每个分组是直接过一遍加密器拼起来，还是前一个分组加密后作为后一个分组加密时密钥计算的输入，前后关联起来，这就涉及到每个分组加密时迭代的方式了，也就是所谓的模式。</p>
<blockquote>
<p>参考资料：</p>
<ol>
<li>结城浩, and 周自恒. 图解密码技术. 北京: 人民邮电出版社, 2015. Print. 图灵程序设计丛书 Tu Ling Cheng Xu She Ji Cong Shu.</li>
<li>Katz J , Lindell Y . Introduction to Modern Cryptography[M]. Chapman &amp; Hall/CRC, 2007.</li>
</ol>
</blockquote>
<p>有些啰嗦了&hellip;有精力还是建议读一遍书↑。</p>
<h3 id="-aes-128-ecb">-aes-128-ecb</h3>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219175310614.png"
    data-srcset="/images/image-20221219175310614.png, /images/image-20221219175310614.png 1.5x, /images/image-20221219175310614.png 2x"
    data-sizes="auto"
    alt="image-20221219175310614"
    title="image-20221219175310614" width="953" height="540"/></p>
<p>电码本模式(Electronic Codebook Book (ECB)): 这种模式是将整个明文分成若干段相同的小段，然后对每一小段进行加密。</p>
<p>实验同理：</p>
<ol>
<li>
<p>加密：<code>openssl enc -aes-128-ecb -e -in plain.txt -out cipher2.bin -K 00112233445566778889aabbccddeeff -p</code> 这边不需要-iv参数。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219175731142.png"
    data-srcset="/images/image-20221219175731142.png, /images/image-20221219175731142.png 1.5x, /images/image-20221219175731142.png 2x"
    data-sizes="auto"
    alt="image-20221219175731142"
    title="image-20221219175731142" width="1051" height="364"/></p>
</li>
<li>
<p>解密：<code>openssl enc -aes-128-ecb -d -in cipher2.bin -out plain3.txt -K 00112233445566778889aabbccddeeff -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221219180243466.png"
    data-srcset="/images/image-20221219180243466.png, /images/image-20221219180243466.png 1.5x, /images/image-20221219180243466.png 2x"
    data-sizes="auto"
    alt="image-20221219180243466"
    title="image-20221219180243466" width="1041" height="472"/></p>
</li>
</ol>
<h3 id="-bf-cbc">-bf-cbc</h3>
<p>实验同理：</p>
<ol>
<li>
<p>加密命令：<code>openssl enc -bf-cbc -e -in plain.txt -out cipher3.bin -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220132017392.png"
    data-srcset="/images/image-20221220132017392.png, /images/image-20221220132017392.png 1.5x, /images/image-20221220132017392.png 2x"
    data-sizes="auto"
    alt="image-20221220132017392"
    title="image-20221220132017392" width="1043" height="565"/></p>
</li>
<li>
<p>解密：<code>openssl enc -bf-cbc -d -in cipher3.bin -out plain4.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220132415320.png"
    data-srcset="/images/image-20221220132415320.png, /images/image-20221220132415320.png 1.5x, /images/image-20221220132415320.png 2x"
    data-sizes="auto"
    alt="image-20221220132415320"
    title="image-20221220132415320" width="1043" height="565"/></p>
</li>
</ol>
<h2 id="task-3-encryption-mode--ecb-vs-cbc">Task 3: Encryption Mode – ECB vs. CBC</h2>
<p>原图：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220134655945.png"
    data-srcset="/images/image-20221220134655945.png, /images/image-20221220134655945.png 1.5x, /images/image-20221220134655945.png 2x"
    data-sizes="auto"
    alt="image-20221220134655945"
    title="image-20221220134655945" width="534" height="481"/></p>
<p>Target：We would like to encrypt this picture, so people without the encryption keys cannot know what is in the picture.</p>
<h3 id="实验ecb模式">实验(ECB模式)</h3>
<ol>
<li>
<p>Encrypt the file using the ECB (Electronic Code Book) mode：</p>
<p><code>openssl enc -aes-128-ecb -e -in pic_original.bmp -out ecb_file.bmp -K 00112233445566778889aabbccddeeff -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220142720794.png"
    data-srcset="/images/image-20221220142720794.png, /images/image-20221220142720794.png 1.5x, /images/image-20221220142720794.png 2x"
    data-sizes="auto"
    alt="image-20221220142720794"
    title="image-20221220142720794" width="1034" height="106"/></p>
</li>
<li>
<p>直接查看加密后的图片，用image viewer(eog)打开：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220142840612.png"
    data-srcset="/images/image-20221220142840612.png, /images/image-20221220142840612.png 1.5x, /images/image-20221220142840612.png 2x"
    data-sizes="auto"
    alt="image-20221220142840612"
    title="image-20221220142840612" width="534" height="128"/></p>
<p>报错信息是这张bmp图片有 <strong>假冒、伪造</strong> 头数据，因此无法加载！</p>
<blockquote>
<p>For the .bmp file, the first 54 bytes contain the header information about the picture, we have to set it correctly, so the encrypted file can be treated as a legitimate .bmp file. =&gt; 从第55字节开始到最后是图片内容</p>
</blockquote>
</li>
<li>
<p>设置正确的header：We will replace the header of the encrypted picture with that of the original picture.</p>
<blockquote>
<p>可以不采取下述命令，直接用bless编辑修改二进制文件也可。</p>
</blockquote>
<ul>
<li>
<p>Get the header from pic_original.bmp: <code>head -c 54 pic_original.bmp &gt; header</code></p>
<p>head命令详解：<a href="https://www.runoob.com/linux/linux-comm-head.html"target="_blank" rel="external nofollow noopener noreferrer">Linux head 命令</a></p>
</li>
<li>
<p>Get the data from ecb_file.bmp (from offset 55 to the end of the file):  <code>tail -c +55 ecb_file.bmp &gt; body</code></p>
<p>tail命令详解：<a href="https://www.runoob.com/linux/linux-comm-tail.html"target="_blank" rel="external nofollow noopener noreferrer">Linux tail 命令</a></p>
</li>
<li>
<p>Combine the header and data together into a new file: <code>cat header body &gt; ecb_file_ok.bmp</code></p>
</li>
</ul>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220153747161.png"
    data-srcset="/images/image-20221220153747161.png, /images/image-20221220153747161.png 1.5x, /images/image-20221220153747161.png 2x"
    data-sizes="auto"
    alt="image-20221220153747161"
    title="image-20221220153747161" width="964" height="105"/></p>
</li>
<li>
<p>再次使用image viewer(eog)打开图片：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220155159815.png"
    data-srcset="/images/image-20221220155159815.png, /images/image-20221220155159815.png 1.5x, /images/image-20221220155159815.png 2x"
    data-sizes="auto"
    alt="image-20221220155159815"
    title="image-20221220155159815" width="535" height="474"/></p>
<p>正常打开！图片内容已经过加密，但是ECB加密模式下只有颜色有所改变，但仍能观察出图片原来的形状轮廓，椭圆+矩形以及相对位置等，可以从加密后图片提炼出原图片的大概信息。</p>
</li>
</ol>
<h3 id="实验cbc模式">实验(CBC模式)</h3>
<p>同理ECB操作流程：</p>
<ol>
<li>
<p>加密：<code>openssl enc -aes-128-cbc -e -in pic_original.bmp -out cbc_file.bmp -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220224038046.png"
    data-srcset="/images/image-20221220224038046.png, /images/image-20221220224038046.png 1.5x, /images/image-20221220224038046.png 2x"
    data-sizes="auto"
    alt="image-20221220224038046"
    title="image-20221220224038046" width="1046" height="163"/></p>
</li>
<li>
<p>设置正确的header</p>
</li>
<li>
<p>查看加密后的图片：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221220224506010.png"
    data-srcset="/images/image-20221220224506010.png, /images/image-20221220224506010.png 1.5x, /images/image-20221220224506010.png 2x"
    data-sizes="auto"
    alt="image-20221220224506010"
    title="image-20221220224506010" width="531" height="410"/></p>
<p>图片已经完全被加密，对比原图和ecb模式，cbc模式加密下的图片完全呈雪花状，不存在ecb中的轮廓可见等现象，肉眼观察下没有能提炼出关于原图的有价值的信息，一片高糊，屏蔽隐藏了原图的信息。</p>
</li>
</ol>
<h3 id="自选图片观察">自选图片观察</h3>
<p>原图：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221221101222859.png"
    data-srcset="/images/image-20221221101222859.png, /images/image-20221221101222859.png 1.5x, /images/image-20221221101222859.png 2x"
    data-sizes="auto"
    alt="image-20221221101222859"
    title="image-20221221101222859" width="532" height="484"/></p>
<p>实验流程同上，首先是ECB模式加密后图片：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221221101718533.png"
    data-srcset="/images/image-20221221101718533.png, /images/image-20221221101718533.png 1.5x, /images/image-20221221101718533.png 2x"
    data-sizes="auto"
    alt="image-20221221101718533"
    title="image-20221221101718533" width="532" height="484"/></p>
<p>这是CBC模式加密后图片：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221221101528955.png"
    data-srcset="/images/image-20221221101528955.png, /images/image-20221221101528955.png 1.5x, /images/image-20221221101528955.png 2x"
    data-sizes="auto"
    alt="image-20221221101528955"
    title="image-20221221101528955" width="532" height="484"/></p>
<p>观察结果同理上述结论，使用ECB模式虽能隐藏图片的具体样式信息等，但仍能提取出关于原图的大概轮廓。而使用CBC模式则加密的比较彻底，完全雪花状，无法观察出任何有关原图的有价值信息。</p>
<h2 id="task-4-padding">Task 4: Padding</h2>
<p>The PKCS#5 padding scheme is widely used by many block ciphers. We will conduct the following experiments to understand how this type of padding works.</p>
<ol>
<li>
<p>分别创建大小为5，10，15字节的文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> -n <span class="s2">&#34;12345&#34;</span> &gt; f1.txt
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -n <span class="s2">&#34;1234567890&#34;</span> &gt; f1.txt
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -n <span class="s2">&#34;678901234513579&#34;</span> &gt; f1.txt
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Without the -n option, the length will be 6, because a newline character will be added by echo.</p>
</blockquote>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226150129916.png"
    data-srcset="/images/image-20221226150129916.png, /images/image-20221226150129916.png 1.5x, /images/image-20221226150129916.png 2x"
    data-sizes="auto"
    alt="image-20221226150129916"
    title="image-20221226150129916" width="991" height="288"/></p>
</li>
<li>
<p>使用AES加密算法(128位密钥，CBC模式)加密上述文件：<code>openssl enc -aes-128-cbc -e -in f1.txt -out f1e.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226151417651.png"
    data-srcset="/images/image-20221226151417651.png, /images/image-20221226151417651.png 1.5x, /images/image-20221226151417651.png 2x"
    data-sizes="auto"
    alt="image-20221226151417651"
    title="image-20221226151417651" width="1049" height="498"/></p>
</li>
<li>
<p>查看加密后文件大小</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226151611453.png"
    data-srcset="/images/image-20221226151611453.png, /images/image-20221226151611453.png 1.5x, /images/image-20221226151611453.png 2x"
    data-sizes="auto"
    alt="image-20221226151611453"
    title="image-20221226151611453" width="814" height="237"/></p>
<p>很明显文件变大了，在加密的过程中有往里面填充。</p>
</li>
<li>
<p>解密文件，查看填充的内容：<code>openssl enc -aes-128-cbc -d -in f1e.txt -out f1d.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -nopad</code></p>
<blockquote>
<p>Unfortunately, decryption by default will automatically remove the padding, making it impossible for us to see the padding. However, the command does have an option called &ldquo;-nopad&rdquo;, which disables the padding, i.e., during the decryption, the command will not remove the padded data.</p>
</blockquote>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226152043114.png"
    data-srcset="/images/image-20221226152043114.png, /images/image-20221226152043114.png 1.5x, /images/image-20221226152043114.png 2x"
    data-sizes="auto"
    alt="image-20221226152043114"
    title="image-20221226152043114" width="1042" height="257"/></p>
<p>观察大小，可以发现填充的字符解密后仍在：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226152143624.png"
    data-srcset="/images/image-20221226152143624.png, /images/image-20221226152143624.png 1.5x, /images/image-20221226152143624.png 2x"
    data-sizes="auto"
    alt="image-20221226152143624"
    title="image-20221226152143624" width="779" height="310"/></p>
</li>
<li>
<p>用xxd命令查看各个解密文件中padding的内容：<code>xxd f1d.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226152834847.png"
    data-srcset="/images/image-20221226152834847.png, /images/image-20221226152834847.png 1.5x, /images/image-20221226152834847.png 2x"
    data-sizes="auto"
    alt="image-20221226152834847"
    title="image-20221226152834847" width="988" height="181"/></p>
<p>-aes-128-cbc模式加密下填充的字符都是<code>.</code>符。</p>
<p>为什么加密后的文件的都是16字节或者说会被填充到16字节 =&gt; 因为AES加密算法分组是128位即16字节，因此一个分组若不满16字节(如上)，会被填充至16字节，若一个文件是16字节大或者32字节大等，则不会进行额外的填充。(?) =&gt; 已验证，错误想法😅，16字节文件在cbc模式下会被填充至32字节。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221228100945605.png"
    data-srcset="/images/image-20221228100945605.png, /images/image-20221228100945605.png 1.5x, /images/image-20221228100945605.png 2x"
    data-sizes="auto"
    alt="image-20221228100945605"
    title="image-20221228100945605" width="719" height="56"/></p>
</li>
</ol>
<p>进一步观察其他模式下填充的内容：</p>
<ol>
<li>
<p>ECB模式</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226153837218.png"
    data-srcset="/images/image-20221226153837218.png, /images/image-20221226153837218.png 1.5x, /images/image-20221226153837218.png 2x"
    data-sizes="auto"
    alt="image-20221226153837218"
    title="image-20221226153837218" width="850" height="442"/></p>
<p>依旧是填充到16字节。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226153942972.png"
    data-srcset="/images/image-20221226153942972.png, /images/image-20221226153942972.png 1.5x, /images/image-20221226153942972.png 2x"
    data-sizes="auto"
    alt="image-20221226153942972"
    title="image-20221226153942972" width="960" height="159"/></p>
<p>仍然是用<code>.</code>填充。</p>
</li>
<li>
<p>CFB模式</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226154436387.png"
    data-srcset="/images/image-20221226154436387.png, /images/image-20221226154436387.png 1.5x, /images/image-20221226154436387.png 2x"
    data-sizes="auto"
    alt="image-20221226154436387"
    title="image-20221226154436387" width="835" height="601"/></p>
<p>可以发现CFB模式下加密时未进行填充，仍为原文件大小。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226154829795.png"
    data-srcset="/images/image-20221226154829795.png, /images/image-20221226154829795.png 1.5x, /images/image-20221226154829795.png 2x"
    data-sizes="auto"
    alt="image-20221226154829795"
    title="image-20221226154829795" width="984" height="182"/></p>
<p>查看内容确实也没有填充字符。</p>
</li>
<li>
<p>OFB模式</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226155142342.png"
    data-srcset="/images/image-20221226155142342.png, /images/image-20221226155142342.png 1.5x, /images/image-20221226155142342.png 2x"
    data-sizes="auto"
    alt="image-20221226155142342"
    title="image-20221226155142342" width="801" height="705"/></p>
<p>OFB模式也未进行填充，大小仍一致。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226155431222.png"
    data-srcset="/images/image-20221226155431222.png, /images/image-20221226155431222.png 1.5x, /images/image-20221226155431222.png 2x"
    data-sizes="auto"
    alt="image-20221226155431222"
    title="image-20221226155431222" width="943" height="178"/></p>
<p>查看内容确实无填充字符。</p>
</li>
</ol>
<div class="details admonition question open">
    <div class="details-summary admonition-title">
      <i class="icon fa-solid fa-question-circle fa-fw" aria-hidden="true"></i>疑惑<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
    </div>
    <div class="details-content">
      <div class="admonition-content">关于为什么同一个算法不同模式有的需要填充有的不需要值得在查阅资料！我现在的一个想法是因为不同模式迭代方式不同，或者说有的是明文直接进加密器(应用加密算法)再配合迭代，那需要满足分组要求(128位等)，有的对于明文本身其实没有直接用加密算法，而是将他和加密出的密钥流进行XOR运算加密的，那其实不要求进行填充，因为它不用进算法。(待考证)</div>
    </div>
  </div>
<h2 id="task-5-error-propagation--corrupted-cipher-text">Task 5: Error Propagation – Corrupted Cipher Text</h2>
<ol>
<li>
<p>创建一个至少1000字节大的文本文件</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226161710611.png"
    data-srcset="/images/image-20221226161710611.png, /images/image-20221226161710611.png 1.5x, /images/image-20221226161710611.png 2x"
    data-sizes="auto"
    alt="image-20221226161710611"
    title="image-20221226161710611" width="653" height="76"/></p>
<p>文件内容均为1</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226161741889.png"
    data-srcset="/images/image-20221226161741889.png, /images/image-20221226161741889.png 1.5x, /images/image-20221226161741889.png 2x"
    data-sizes="auto"
    alt="image-20221226161741889"
    title="image-20221226161741889" width="1123" height="368"/></p>
</li>
<li>
<p>用AES加密算法(128位密钥，ECB模式)加密这个文件：<code>openssl enc -aes-128-ecb -e -in f.txt -out fecb.txt -K 00112233445566778889aabbccddeeff -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226161955796.png"
    data-srcset="/images/image-20221226161955796.png, /images/image-20221226161955796.png 1.5x, /images/image-20221226161955796.png 2x"
    data-sizes="auto"
    alt="image-20221226161955796"
    title="image-20221226161955796" width="1114" height="104"/></p>
</li>
<li>
<p>用bless工具修改密文中第55个字节中的1个bit</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226221702077.png"
    data-srcset="/images/image-20221226221702077.png, /images/image-20221226221702077.png 1.5x, /images/image-20221226221702077.png 2x"
    data-sizes="auto"
    alt="image-20221226221702077"
    title="image-20221226221702077" width="842" height="396"/></p>
<p>如下：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226221737565.png"
    data-srcset="/images/image-20221226221737565.png, /images/image-20221226221737565.png 1.5x, /images/image-20221226221737565.png 2x"
    data-sizes="auto"
    alt="image-20221226221737565"
    title="image-20221226221737565" width="842" height="396"/></p>
</li>
<li>
<p>用正确的密钥和初始向量解密被上述修改后的密文：<code>openssl enc -aes-128-ecb -d -in fecb.txt -out fecbd.txt -K 00112233445566778889aabbccddeeff -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226183642262.png"
    data-srcset="/images/image-20221226183642262.png, /images/image-20221226183642262.png 1.5x, /images/image-20221226183642262.png 2x"
    data-sizes="auto"
    alt="image-20221226183642262"
    title="image-20221226183642262" width="1124" height="129"/></p>
<p>查看解密后的明文：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226221854591.png"
    data-srcset="/images/image-20221226221854591.png, /images/image-20221226221854591.png 1.5x, /images/image-20221226221854591.png 2x"
    data-sizes="auto"
    alt="image-20221226221854591"
    title="image-20221226221854591" width="1124" height="389"/></p>
<p>可以很清楚发现虽然我只修改了密文的一个bit，并使用了正确的密钥和初始向量，但是解密后对明文的影响仍是蔓延了将近14，15个字节的乱码，乱码之处完全无法看出原来正确明文的痕迹，可以想象，若错误的比特数增多几个，对解密的影响是非常大的。 =&gt; <a href="https://en.wikipedia.org/wiki/Avalanche_effect"target="_blank" rel="external nofollow noopener noreferrer">Avalanche Effect</a></p>
</li>
</ol>
<p>进一步使用AES算法128位密钥其余模式：</p>
<ol>
<li>
<p>CBC模式</p>
<p>加密：<code>openssl enc -aes-128-cbc -e -in f.txt -out fcbc.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p>解密：<code>openssl enc -aes-128-cbc -d -in fcbc.txt -out fcbcd.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226221343036.png"
    data-srcset="/images/image-20221226221343036.png, /images/image-20221226221343036.png 1.5x, /images/image-20221226221343036.png 2x"
    data-sizes="auto"
    alt="image-20221226221343036"
    title="image-20221226221343036" width="1123" height="392"/></p>
<p>同样也是多字节乱码。</p>
</li>
<li>
<p>OFB模式</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221226222330663.png"
    data-srcset="/images/image-20221226222330663.png, /images/image-20221226222330663.png 1.5x, /images/image-20221226222330663.png 2x"
    data-sizes="auto"
    alt="image-20221226222330663"
    title="image-20221226222330663" width="1129" height="393"/></p>
<p>OFB模式不同于上述两种模式，并没有产生雪崩效应，解密被破坏的密文可以发现，上述错误出现在第55字节，即解密后的明文中只有被修改的那个字节出现了问题，其余字节均不受影响。</p>
</li>
</ol>
<h2 id="task-6-initial-vector-iv-and-common-mistakes">Task 6: Initial Vector (IV) and Common Mistakes</h2>
<h3 id="61-iv-experiment">6.1 IV Experiment</h3>
<ol>
<li>
<p>用-aes-128-cbc模式，采用相同的密钥和不同的IV加密一个相同的文件f.txt</p>
<p>命令1：<code>openssl enc -aes-128-cbc -e -in f.txt -out f6cbc1.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p>命令2：<code>openssl enc -aes-128-cbc -e -in f.txt -out f6cbc2.txt -K 00112233445566778889aabbccddeeff -iv 0102030409080706 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227142034191.png"
    data-srcset="/images/image-20221227142034191.png, /images/image-20221227142034191.png 1.5x, /images/image-20221227142034191.png 2x"
    data-sizes="auto"
    alt="image-20221227142034191"
    title="image-20221227142034191" width="1046" height="334"/></p>
</li>
<li>
<p>查看加密结果：</p>
<p><code>cat f6cbc1.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227142229010.png"
    data-srcset="/images/image-20221227142229010.png, /images/image-20221227142229010.png 1.5x, /images/image-20221227142229010.png 2x"
    data-sizes="auto"
    alt="image-20221227142229010"
    title="image-20221227142229010" width="990" height="324"/></p>
<p><code>cat f6cbc2.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227142248589.png"
    data-srcset="/images/image-20221227142248589.png, /images/image-20221227142248589.png 1.5x, /images/image-20221227142248589.png 2x"
    data-sizes="auto"
    alt="image-20221227142248589"
    title="image-20221227142248589" width="989" height="573"/></p>
<p>单看加密文档结尾部分也可发现加密出的结果是不相同的。</p>
</li>
<li>
<p>用-aes-128-cbc模式，采用相同的密钥和相同的IV加密一个相同的文件f.txt</p>
<p>命令：<code>openssl enc -aes-128-cbc -e -in f.txt -out f6cbc3.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227142633569.png"
    data-srcset="/images/image-20221227142633569.png, /images/image-20221227142633569.png 1.5x, /images/image-20221227142633569.png 2x"
    data-sizes="auto"
    alt="image-20221227142633569"
    title="image-20221227142633569" width="991" height="334"/></p>
</li>
<li>
<p>查看两次加密的结果：</p>
<p><code>cat f6cbc3.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227142732926.png"
    data-srcset="/images/image-20221227142732926.png, /images/image-20221227142732926.png 1.5x, /images/image-20221227142732926.png 2x"
    data-sizes="auto"
    alt="image-20221227142732926"
    title="image-20221227142732926" width="990" height="320"/></p>
<p><code>cat f6cbc4.txt</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227142754403.png"
    data-srcset="/images/image-20221227142754403.png, /images/image-20221227142754403.png 1.5x, /images/image-20221227142754403.png 2x"
    data-sizes="auto"
    alt="image-20221227142754403"
    title="image-20221227142754403" width="990" height="320"/></p>
<p>可以发现两次加密的结果是完全一样的！</p>
</li>
<li>
<p>思考为什么IV必须唯一！</p>
<p>通过上述实验可以发现，相同的密钥情况下，不同的IV加密同样内容结果不同，同样的IV加密同样的内容结果是相同的。换句话说即在CBC模式下，重复使用 IV 会导致带有相同部分的明文加密结果是相同部分的密文。显然存在安全威胁，重复使用可能会保留下明文中存在的敏感特征(类比上面实验中你可能确实加密了内容，但是仍能观察出轮廓、方位等敏感信息)，且万一IV泄露，攻击者可以用相同IV加密一篇已知明文，通过对比密文的相似性来解密。因此IV必须唯一，不可以重复使用。</p>
<p>如何显现敏感特征进一步说明一下比如现对一张图片进行逐行加密，每行都使用相同的IV，那根据前述性质，这张图片相同行加密出的结果应该是相同的，那最后加密结果中可以想象可能会存在相同阴影包裹着不同的阴影？二者分界面就是轮廓？不同的阴影散落在不同位置可能暗含明文布局？等信息/情况，不是说一定会泄露，还要看图片结构、实际构成等。</p>
<p>！还需要进一步考证，说法有待商榷。参考资料：<a href="https://cloud.tencent.com/developer/article/2171237"target="_blank" rel="external nofollow noopener noreferrer">30分钟搞定AES系列（下）：IV与加密语义安全性探究</a></p>
</li>
</ol>
<h3 id="62-common-mistake-use-the-same-iv">6.2. Common Mistake: Use the Same IV</h3>
<p>已知明文攻击(Known-plaintext Attack)</p>
<blockquote>
<p>The attack used in this experiment is called the known-plaintext attack, which is an attack model for cryptanalysis where the attacker has access to both the plaintext and its encrypted version (ciphertext). If this can lead to the revealing of further secret information, the encryption scheme is not considered as secure.</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Plaintext (P1): This is a known message!
</span></span><span class="line"><span class="cl">Ciphertext (C1): a469b1c502c1cab966965e50425438e1bb1b5f9037a4c159
</span></span><span class="line"><span class="cl">Plaintext (P2): (unknown to you)
</span></span><span class="line"><span class="cl">Ciphertext (C2): bf73bcd3509299d566c35b5d450337e1bb175f903fafc159
</span></span></code></pre></td></tr></table>
</div>
</div><p>假设采用OFB模式进行加密，加密时所采用的IV是相同的，破译P2：</p>
<p>先看OFB模式，参考于https://blog.csdn.net/chengqiuming/article/details/82390910</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/70.png"
    data-srcset="/images/70.png, /images/70.png 1.5x, /images/70.png 2x"
    data-sizes="auto"
    alt="img"
    title="img" width="686" height="336"/></p>
<p>重点在于OFB模式下不是通过密码算法对明文直接加密的，而是通过将“明文分组”和“密码算法的输出”进行XOR来产生“密文分组”的。在这里我们可以忽略加密算法的细节(或者说XOR密钥流的产生过程)，重点关注XOR的双方，进行如下推导：
$$
P1\oplus KEY1 = C1
$$
$$
P2 \oplus KEY2 = C2
$$</p>
<p>由于IV是相同的，因此经过加密算法产生的XOR密钥流是相同的即KEY1=KEY2，因此如下继续推导：
$$
P1\oplus KEY = C1
$$
$$
P2 \oplus KEY = C2
$$</p>
<p>$$
=&gt; KEY=C1\oplus P1
$$</p>
<p>$$
=&gt; P2=C2\oplus KEY=C2 \oplus C1 \oplus P1
$$</p>
<p>由此得到破译P2的方式，已知三者进行进行异或运算即可。实验过程如下：</p>
<ol>
<li>
<p>利用python实现三个已知字符串的异或操作</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># XOR two bytearrays</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">xˆy</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">MSG</span> <span class="o">=</span> <span class="s2">&#34;This is a known message!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">HEX_1</span> <span class="o">=</span> <span class="s2">&#34;a469b1c502c1cab966965e50425438e1bb1b5f9037a4c159&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">HEX_2</span> <span class="o">=</span> <span class="s2">&#34;bf73bcd3509299d566c35b5d450337e1bb175f903fafc159&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Convert ascii/hex string to bytearray</span>
</span></span><span class="line"><span class="cl"><span class="n">D1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">MSG</span><span class="p">,</span> <span class="err">’</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span><span class="err">’</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">D2</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">HEX_1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">D3</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">HEX_2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r1</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r2</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">D3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>执行：<code>python3 sample_code.py</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227225240350.png"
    data-srcset="/images/image-20221227225240350.png, /images/image-20221227225240350.png 1.5x, /images/image-20221227225240350.png 2x"
    data-sizes="auto"
    alt="image-20221227225240350"
    title="image-20221227225240350" width="1039" height="81"/></p>
<p>得到P2的二进制(16进制表示)字符串。</p>
</li>
<li>
<p>利用Bless工具解码二进制字符串</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221227225846388.png"
    data-srcset="/images/image-20221227225846388.png, /images/image-20221227225846388.png 1.5x, /images/image-20221227225846388.png 2x"
    data-sizes="auto"
    alt="image-20221227225846388"
    title="image-20221227225846388" width="834" height="431"/></p>
<p>获得明文P2：Order: Launch a missile!</p>
</li>
</ol>
<h3 id="63-common-mistake-use-a-predictable-iv">6.3. Common Mistake: Use a Predictable IV</h3>
<p><strong>选择明文攻击：Chosen-plaintext Attack</strong></p>
<blockquote>
<p>A good cipher should not only tolerate the known-plaintext attack described previously, it should also tolerate the chosen-plaintext attack, which is an attack model for cryptanalysis where the attacker can obtain the ciphertext for an arbitrary plaintext.</p>
</blockquote>
<p>=&gt; Your job is to construct a message and ask Bob to encrypt it and give you the ciphertext. Your objective is to use this opportunity to figure out whether the actual content of Bob’s secret message is Yes or No. For this task, your are given an encryption oracle which simulates Bob and encrypts message with 128-bit AES with CBC mode.</p>
<p>=&gt; 请确定密文C1对应的明文内容是Yes还是No</p>
<ol>
<li>
<p>启动容器，Labsetup下：<code>docker-compose up -d</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221228100125600.png"
    data-srcset="/images/image-20221228100125600.png, /images/image-20221228100125600.png 1.5x, /images/image-20221228100125600.png 2x"
    data-sizes="auto"
    alt="image-20221228100125600"
    title="image-20221228100125600" width="1833" height="105"/></p>
</li>
<li>
<p>接入oracle：<code>nc 10.9.0.80 3000</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221228134241295.png"
    data-srcset="/images/image-20221228134241295.png, /images/image-20221228134241295.png 1.5x, /images/image-20221228134241295.png 2x"
    data-sizes="auto"
    alt="image-20221228134241295"
    title="image-20221228134241295" width="1165" height="184"/></p>
</li>
</ol>
<p>根据前面介绍过的CBC模式，构造明文思路为：</p>
<p>设要猜测的记录$P_i$某个字段的值是$P_x$，next IV是IV，$C_{i-1}$是$P_i$前一条明文的密文，即如下构造$P_M$
$$
P_M=IV\oplus C_{i-1}\oplus P_X
$$
将其发送给服务端进行加密，CBC加密过程如下：
$$
C_M = E(k,IV\oplus P_M)
$$
$$
=&gt; C_M=E(k,C_{i-1}\oplus P_X)
$$</p>
<p>比较$C_M$与$C_i$就知道猜测的明文是否正确。</p>
<p>参考资料：<a href="https://www.bilibili.com/read/cv11699994/"target="_blank" rel="external nofollow noopener noreferrer">【现代密码学入门】33. CBC模式 (3)：选择IV，水很深！</a>、<a href="https://quant67.com/post/crypt/cbc-crack/attack-on-cbc.html"target="_blank" rel="external nofollow noopener noreferrer">对 CBC 模式的一些攻击</a>、<a href="https://en.wikipedia.org/wiki/Initialization_vector"target="_blank" rel="external nofollow noopener noreferrer">Initialization vector</a></p>
<p>基于此在该实验进行如下明文构造：首先不知道$C_{i-1}$，但其实也用不到他，因为题目已知明文不是yes就是no，明文有效值很短(不是上面推理时明文很长，猜测中间分组的部分的情况)，因此是在第一分组中的即是和IV异或而不是和前一个密文分组异或(因字节问题填充出来的不考虑，不影响结果yes/no)。所以明文构造：
$$
P_2=IV\oplus IV&rsquo; \oplus P_x
$$
其中IV是next IV，IV‘是the IV used，$P_x$是猜测的明文值。</p>
<ol start="3">
<li>
<p>因为P1不是“YES”就是“NO”，因此首先猜测YES。借助openssl enc获取填充后的YES的16进制字符串。</p>
<ul>
<li>
<p>新建包含Yes的文件：<code>echo -n &quot;Yes&quot; &gt; ftest.txt</code></p>
</li>
<li>
<p>加密：<code>openssl enc -aes-128-cbc -e -in ftest.txt -out ftestcbc.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -p</code></p>
</li>
<li>
<p>解密(保留填充字符): <code>openssl enc -aes-128-cbc -d -in ftestcbc.txt -out ftestcbcd.txt -K 00112233445566778889aabbccddeeff -iv 0102030405060708 -nopad</code></p>
</li>
<li>
<p>查看16进制字符串：<code>xxd ftestcbcd.txt</code></p>
</li>
</ul>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221228134317777.png"
    data-srcset="/images/image-20221228134317777.png, /images/image-20221228134317777.png 1.5x, /images/image-20221228134317777.png 2x"
    data-sizes="auto"
    alt="image-20221228134317777"
    title="image-20221228134317777" width="1125" height="57"/></p>
<p>所获得的16进制字符串即构造公式中的$P_x$。关键是获取Yes的16进制以及填充字符。</p>
</li>
<li>
<p>使用python进行IV，IV’，$P_x$三者的异或</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># XOR two bytearrays</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">xˆy</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HEX_1</span> <span class="o">=</span> <span class="s2">&#34;a0c95b7d5d98a4033fd545fdb0e1072f&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">HEX_2</span> <span class="o">=</span> <span class="s2">&#34;5cefb4cb5d98a4033fd545fdb0e1072f&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">HEX_3</span> <span class="o">=</span> <span class="s2">&#34;5965730d0d0d0d0d0d0d0d0d0d0d0d0d&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Convert ascii/hex string to bytearray</span>
</span></span><span class="line"><span class="cl"><span class="n">D1</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">HEX_1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">D2</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">HEX_2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">D3</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">HEX_3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r1</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r2</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">D3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r2</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>运行python代码：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221228135352451.png"
    data-srcset="/images/image-20221228135352451.png, /images/image-20221228135352451.png 1.5x, /images/image-20221228135352451.png 2x"
    data-sizes="auto"
    alt="image-20221228135352451"
    title="image-20221228135352451" width="901" height="81"/></p>
<p>所得字符串即我们构造的明文$P_2$，将其输入进oracle中</p>
</li>
<li>
<p>加密P2并观察密文C2和C1：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221228135546267.png"
    data-srcset="/images/image-20221228135546267.png, /images/image-20221228135546267.png 1.5x, /images/image-20221228135546267.png 2x"
    data-sizes="auto"
    alt="image-20221228135546267"
    title="image-20221228135546267" width="1354" height="298"/></p>
<blockquote>
<p>因为我们输入的是16字节文件，在CBC模式下，根据填充规则，16字节会补全到32字节，因此输出也有32字节，但是cbc的加密规则下，我们只需关注前16字节即可，填充出来的16字节不影响观察结果。</p>
</blockquote>
<p>可以发现前16字节密文和C1是一样的，也就是说Bob的明文正是Yes。</p>
</li>
</ol>
<p>参考资料：<a href="https://crypto.stackexchange.com/questions/63675/simulation-of-chosen-plaintext-attack-on-cbc-predictable-iv-with-openssl"target="_blank" rel="external nofollow noopener noreferrer">Simulation of Chosen Plaintext Attack on CBC, Predictable IV with OpenSSL</a></p>
<h2 id="task-7-programming-using-the-crypto-library">Task 7: Programming using the Crypto Library</h2>
<p>In this task, you are given a plaintext and a ciphertext, and your job is to find the key that is used for the encryption. You do know the following facts:</p>
<ul>
<li>The aes-128-cbc cipher is used for the encryption.</li>
<li>The key used to encrypt this plaintext is an English word shorter than 16 characters; the word can be found from a typical English dictionary. Since the word has less than 16 characters (i.e. 128 bits), pound signs (#: hexadecimal value is 0x23) are appended to the end of the word to form a key of 128 bits.</li>
</ul>
<p>Your goal is to write a program to find out the encryption key.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Plaintext (total 21 characters): This is a top secret.
</span></span><span class="line"><span class="cl">Ciphertext (in hex format): 764aa26b55a4da654df6b19e4bce00f4ed05e09346fb0e762583cb7da2ac93a2
</span></span><span class="line"><span class="cl">IV (in hex format): aabbccddeeff00998877665544332211
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>
<p>调用crypto library进行c语言编程。</p>
<p>思路是：遍历words.txt，依次用words.txt中的词作key和已知IV对已知明文加密，若所得密文和所给密文相同，则当前所用key即代表所要破译的key。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;openssl/evp.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;assert.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;ctype.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">str2hex</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span><span class="c1">//将16进制字符串 =&gt; 16进制字符数组即计算机能理解的16进制字符串(原先计算机角度可能只是普通字符串而不是hexstring)
</span></span></span><span class="line"><span class="cl"><span class="c1">//举例：16进制字符串“aabbcc”实际上是2位1字节即0xaa,0xbb,0xcc,因此我们需要[0xaa,0xbb,0xcc]字符数组形式，char一个字符一字节，即2位16进制。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ret</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">str_len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert</span><span class="p">((</span><span class="n">str_len</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">str_len</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">str_len</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">sscanf</span><span class="p">(</span><span class="n">str</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="s">&#34;%2hhx&#34;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]);</span><span class="c1">//每两位一读取，h是指定对应数据大小为短整型，两位每位对应一个h，x指定了要被读取的数据类型以及数据读取方式为十六进制整数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">strCmp</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">){</span><span class="c1">//比较加密所得密文字符串和已给密文字符串是否一致
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span><span class="p">(;;</span><span class="n">a</span><span class="o">++</span><span class="p">,</span><span class="n">b</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="n">d</span><span class="o">=</span><span class="n">tolower</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">tolower</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">);</span><span class="c1">//逐位转小写并相减 =&gt; 与零相比
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="o">!=</span><span class="mi">0</span> <span class="o">||</span> <span class="o">!*</span><span class="n">a</span><span class="p">)</span><span class="c1">//若不等于0即不相等，直接返回；若等于0即当前位相等的情况下，执行a++，b++，比较下一位，若一直等于0即一直相等，则比较至a指向空，说明每位均相等，此时d仍为0，依托!*a条件进行返回，两个字符串相等即返回d=0。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="k">return</span> <span class="n">d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//do_crypt参考实验手册所给网址https://www.openssl.org/docs/man1.1.1/man3/EVP_CipherInit.html中说明及加密示例，并进行了修改
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">do_crypt</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">outfile</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span><span class="c1">//*outfile传入结果要写入的文件名，*key为经过填充处理的words.txt中单词所构成的密钥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">outbuf</span><span class="p">[</span><span class="mi">1024</span><span class="o">+</span><span class="n">EVP_MAX_BLOCK_LENGTH</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">     <span class="kt">char</span> <span class="n">givenCipher</span><span class="p">[]</span><span class="o">=</span><span class="s">&#34;764aa26b55a4da654df6b19e4bce00f4ed05e09346fb0e762583cb7da2ac93a2&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="kt">int</span> <span class="n">outlen</span><span class="p">,</span> <span class="n">tmplen</span><span class="p">,</span><span class="n">flag</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="c1">//flag用来标志本轮密钥是否符合要求，并作为函数返回值指示主函数是否已找到并结束后续循环。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">      * Bogus key and IV: we&#39;d normally set these from
</span></span></span><span class="line"><span class="cl"><span class="cm">      * another source.
</span></span></span><span class="line"><span class="cl"><span class="cm">      */</span>
</span></span><span class="line"><span class="cl">     <span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span> <span class="n">iv</span><span class="o">=</span><span class="n">str2hex</span><span class="p">(</span><span class="s">&#34;aabbccddeeff00998877665544332211&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="kt">char</span> <span class="o">*</span><span class="n">intext</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">intext</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">21</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">memcpy</span><span class="p">(</span><span class="n">intext</span><span class="p">,</span><span class="s">&#34;This is a top secret.&#34;</span><span class="p">,</span><span class="mi">21</span><span class="p">);</span><span class="c1">//写入明文
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">EVP_CIPHER_CTX</span> <span class="o">*</span><span class="n">ctx</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">FILE</span> <span class="o">*</span><span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">ctx</span> <span class="o">=</span> <span class="n">EVP_CIPHER_CTX_new</span><span class="p">();</span><span class="c1">//创建密码上下文
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">EVP_EncryptInit_ex</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">EVP_aes_128_cbc</span><span class="p">(),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">);</span><span class="c1">//设置密码上下文，加密算法、密钥、初始向量等
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		 <span class="c1">//加密
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">EVP_EncryptUpdate</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">outbuf</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">outlen</span><span class="p">,</span> <span class="n">intext</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">intext</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="cm">/* Error */</span>
</span></span><span class="line"><span class="cl">         <span class="n">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">      * Buffer passed to EVP_EncryptFinal() must be after data just
</span></span></span><span class="line"><span class="cl"><span class="cm">      * encrypted to avoid overwriting it.
</span></span></span><span class="line"><span class="cl"><span class="cm">      */</span>
</span></span><span class="line"><span class="cl">     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">EVP_EncryptFinal_ex</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">outbuf</span> <span class="o">+</span> <span class="n">outlen</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tmplen</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="cm">/* Error */</span>
</span></span><span class="line"><span class="cl">         <span class="n">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="n">outlen</span> <span class="o">+=</span> <span class="n">tmplen</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="n">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">      * Need binary mode for fopen because encrypted data is
</span></span></span><span class="line"><span class="cl"><span class="cm">      * binary data. Also cannot use strlen() on it because
</span></span></span><span class="line"><span class="cl"><span class="cm">      * it won&#39;t be NUL terminated and may contain embedded
</span></span></span><span class="line"><span class="cl"><span class="cm">      * NULs.
</span></span></span><span class="line"><span class="cl"><span class="cm">      */</span>
</span></span><span class="line"><span class="cl">     <span class="n">out</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#34;wb&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">if</span> <span class="p">(</span><span class="n">out</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="cm">/* Error */</span>
</span></span><span class="line"><span class="cl">         <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="kt">char</span> <span class="o">*</span><span class="n">buf_str</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">outlen</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="kt">char</span> <span class="o">*</span><span class="n">buf_ptr</span><span class="o">=</span><span class="n">buf_str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">outlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">     	<span class="n">buf_ptr</span><span class="o">+=</span><span class="n">sprintf</span><span class="p">(</span><span class="n">buf_ptr</span><span class="p">,</span><span class="s">&#34;%02X&#34;</span><span class="p">,</span><span class="n">outbuf</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="o">*</span><span class="p">(</span><span class="n">buf_ptr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="c1">//将加密后的密文以16进制形式另存，头指针buf_str
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="c1">//printf(&#34;%s&#34;,givenCipher);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="k">if</span><span class="p">(</span><span class="n">strCmp</span><span class="p">(</span><span class="n">givenCipher</span><span class="p">,</span><span class="n">buf_str</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span><span class="c1">//利用strCmp函数比较givenCipher和buf_str，即比较当前密钥加密后的密文与原密文，若相等即返回值为0，则将其写入文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     	 <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">strlen</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     	 		<span class="n">fprintf</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="s">&#34;%c&#34;</span><span class="p">,</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="c1">//写入密钥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     	 <span class="n">fprintf</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="s">&#34;%c&#34;</span><span class="p">,</span><span class="sc">&#39; &#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	     <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">outlen</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	     		<span class="n">fprintf</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="s">&#34;%02x&#34;</span><span class="p">,</span><span class="n">outbuf</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="c1">//写入密文
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	     <span class="n">flag</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="c1">//标志位置为2代表本次密钥符合要求
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="p">}</span>
</span></span><span class="line"><span class="cl">     <span class="n">fclose</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">flag</span><span class="p">;</span><span class="c1">//返回flag，1本轮密钥不符合，2为符合
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kt">void</span> <span class="nf">padding</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">length</span><span class="p">){</span><span class="c1">//密钥填充函数，s是words.txt中单词字符串，length是要填充到的长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 	<span class="kt">int</span> <span class="n">l</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">l</span><span class="o">=</span><span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 	<span class="k">while</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;</span><span class="n">length</span><span class="p">){</span>
</span></span><span class="line"><span class="cl"> 		<span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;#&#39;</span><span class="p">;</span><span class="c1">//填充#字符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 		<span class="n">l</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="p">}</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="c1">//printf(&#34;%s\n&#34;,s);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl"> 	<span class="kt">char</span> <span class="n">words</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="o">*</span><span class="n">outfile</span><span class="o">=</span><span class="s">&#34;task7decrypt.txt&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">FILE</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="o">*</span><span class="n">out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="k">if</span><span class="p">((</span><span class="n">key</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s">&#34;words.txt&#34;</span><span class="p">,</span><span class="s">&#34;r&#34;</span><span class="p">))</span><span class="o">==</span><span class="nb">NULL</span><span class="p">){</span>
</span></span><span class="line"><span class="cl"> 		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Open Error!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="p">}</span><span class="c1">//打开words.txt
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">feof</span><span class="p">(</span><span class="n">key</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl"> 		<span class="n">fgets</span><span class="p">(</span><span class="n">words</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="n">key</span><span class="p">);</span><span class="c1">//每次读入一个单词
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 		<span class="n">i</span><span class="o">=</span><span class="n">strlen</span><span class="p">(</span><span class="n">words</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 		<span class="n">words</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="c1">//在text editor中自动添加了null或者文件结束符等，因此在这里去除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 		<span class="n">i</span><span class="o">=</span><span class="n">strlen</span><span class="p">(</span><span class="n">words</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 		<span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">)</span><span class="c1">//AES-128要求密钥长度是16字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 			<span class="n">padding</span><span class="p">(</span><span class="n">words</span><span class="p">,</span><span class="mi">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Test key:%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">words</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 		<span class="n">j</span><span class="o">=</span><span class="n">do_crypt</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">words</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="c1">//do_crypt()返回值为2说明已匹配到正确的密钥，break结束循环
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> 			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 	<span class="p">}</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;The discovered key has already been saved in File task7decrypt.txt.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">fclose</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>编译及运行：<code>gcc -o task7 task7.c -lcrypto</code></p>
<p>运行：<code>./task7</code></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221230094338035.png"
    data-srcset="/images/image-20221230094338035.png, /images/image-20221230094338035.png 1.5x, /images/image-20221230094338035.png 2x"
    data-sizes="auto"
    alt="image-20221230094338035"
    title="image-20221230094338035" width="885" height="728"/></p>
<p>查看key：</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="/images/image-20221230094410411.png"
    data-srcset="/images/image-20221230094410411.png, /images/image-20221230094410411.png 1.5x, /images/image-20221230094410411.png 2x"
    data-sizes="auto"
    alt="image-20221230094410411"
    title="image-20221230094410411" width="1458" height="50"/></p>
<p>从而找到使用的密钥Key：Syracuse</p>
</li>
</ol>
<blockquote>
<p>参考资料：</p>
<ol>
<li><a href="https://blog.csdn.net/l4kjih3gfe2dcba1/article/details/119145719"target="_blank" rel="external nofollow noopener noreferrer">Secret-Key Encryption Lab网安实验</a></li>
<li><a href="https://www.vsaytech.com/others/crypto-lab-secret-key-encryption-part-2/"target="_blank" rel="external nofollow noopener noreferrer">Crypto Lab – Secret-Key Encryption (Part 2)</a></li>
<li><a href="https://www.openssl.org/docs/man1.1.1/man3/EVP_CipherInit.html"target="_blank" rel="external nofollow noopener noreferrer">EVP_EncryptInit</a></li>
<li><a href="https://stackoverflow.com/questions/17945718/converting-a-hex-string-array-to-hex-array"target="_blank" rel="external nofollow noopener noreferrer">converting a hex string array to hex array (duplicate)</a></li>
<li><a href="https://www.runoob.com/cprogramming/c-function-sscanf.html"target="_blank" rel="external nofollow noopener noreferrer">C 库函数 - sscanf()</a></li>
</ol>
</blockquote></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title=2022-12-30&#32;10:00:15>更新于 2022-12-30&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span></span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2%E5%AE%9E%E9%AA%8C/' class="post-tag">网络安全攻防实验</a><a href='/tags/cryptography/' class="post-tag">Cryptography</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/tcp-ip-attack/" class="post-nav-item" rel="prev" title="TCP/IP攻击"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>TCP/IP攻击</a>
      <a href="/posts/rsa-public-key-encryption-and-signature-lab/" class="post-nav-item" rel="next" title="RSA公钥加密和数字签名实验">RSA公钥加密和数字签名实验<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="https://github.com/LaneGong"target="_blank" rel="external nofollow noopener noreferrer">Lane Gong</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class="site-time" title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden="true"></i>&nbsp;<span class="run-times">网站运行中 ...</span></span></div><div class="footer-line ibruce">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/algoliasearch/algoliasearch-lite.umd.min.js" defer></script><script src="/lib/lazysizes/lazysizes.min.js" async defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"","algoliaIndex":"","algoliaSearchKey":"","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30,"type":"algolia"},"siteTime":"2022-11-23T15:00:00+08:00"};</script><script src="/js/theme.min.js" defer></script></body>
</html>
